Descripcion
Renta y venta de vestidos. Software desarrollado para personal de la boutique. Deberan haber 2 vistas, que aunque similares seran enfocadas a diferentes usuarios, uno del personal para administrar las diferentes rentas de diferentes articulos y otro para administradores, enfocado mas en estadisticas.


Reglas de Negocio:
1. Adelanto necesario para poder rentar y liberar un contrato
2. se tiene que firmar un contrato para poder entregar el vestido.
3. Se entrega al cliente 2 dias antes del evento, y se entrega al local el dia siguiente
4.  Cada dia extra pasado del plazo establecido representara una multa de x cantidad (digamos 100)
5. Se necesita saber el nombre, telefono, correo del cliente.
6. Se da de baja un vestido momentaneamente cuando este rentado
7. se emiten alertas tanto a los clientes (via correo - telefono) y al mismo sistema cuando fechas importantes (de entrega, devolucion, fecha limite, detalles, etc) como al sistema mismo
8. Para rentar se le solicitara al cliente su INE, nombre, correo, telefono, detalles de pedido (prendas, fechas, notas, pagos, etc)
9. La INE del cliente se guarda en un bucket.

Habra un catalogo de vestidos para modificar su estatus y agregar mas.


REQUERIMIENTOS:
- ADMIN
	- Estadisticas de ventas, vestidos, acceso al inventario y catalogo de prendas
	- Hisorial de ventas
	- gestion del personal
	- proyeccion de ventas
- STAFF
        	- vista de calendario, que resalta actividad con los vestidos (segun su estado, y seran x mes, solo aplica a pedidos fuera del estatus finished)
	-  dashboard con datos generales de ventas.
	- acceso a catalogo, con opcion de añadir notas a los vestidos
	- un inventario
	-  generacion de contratos en formato PDF de manera automatica con los datos del cliente (con formato fijo)
	- reservacion de vestidos para renta, solicitando los datos especificados en las reglas del negocion, incluyendo escaneo y guardado de INE



-- 1. TABLA PROFILES 
CREATE TABLE "Profiles" (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  name TEXT,
  last_name TEXT,
  email VARCHAR,
  phone TEXT, -- Cambiado a TEXT para soportar ladas (+52)
  role_user TEXT DEFAULT 'staff', -- 'admin' o 'staff'
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2. TABLA PRODUCTS (Vestidos)
CREATE TABLE "Products" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name TEXT NOT NULL,
  description TEXT,
  price FLOAT NOT NULL, -- Precio de renta
  details TEXT, -- Talla, color, etc.
  notes VARCHAR,
  image_url TEXT, -- Recomendado agregar para la foto
  status TEXT DEFAULT 'available', -- available, rented, maintenance
  last_modified TIMESTAMPTZ DEFAULT NOW(),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 3. TABLA CUSTOMERS (Clientes)
CREATE TABLE "Customers" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name TEXT NOT NULL,
  last_name TEXT,
  INE_url VARCHAR, -- URL del archivo en Storage
  phone TEXT,
  email VARCHAR,
  blacklisted TEXT, -- Puede ser 'true'/'false' o la razón del bloqueo
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 4. TABLA ORDERS (Rentas/Pedidos)
CREATE TABLE "Orders" (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  
  -- Relaciones (Foreign Keys)
  product_id BIGINT REFERENCES "Products"(id),
  customer_id BIGINT REFERENCES "Customers"(id),
  staff_id UUID REFERENCES "Profiles"(id), -- UUID porque Profiles usa UUID
  
  -- Fechas
  delivery_date DATE NOT NULL, -- Cuándo se entrega al cliente
  due_date DATE NOT NULL,      -- Cuándo debe regresar
  return_date TIMESTAMPTZ,     -- Fecha real de devolución (Para calcular multas)
  
  -- Detalles
  notes VARCHAR,
  contract_url VARCHAR,
  status TEXT DEFAULT 'pending', -- pending, active, completed, late
  
  -- Dinero (Vital para tus reglas de negocio)
  advance_payment FLOAT DEFAULT 0, -- El adelanto
  penalty_fee FLOAT DEFAULT 0,     -- La multa
  
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Habilitar seguridad (Row Level Security)
ALTER TABLE "Profiles" ENABLE ROW LEVEL SECURITY;
ALTER TABLE "Products" ENABLE ROW LEVEL SECURITY;
ALTER TABLE "Customers" ENABLE ROW LEVEL SECURITY;
ALTER TABLE "Orders" ENABLE ROW LEVEL SECURITY;

-- Políticas de acceso básicas (Permitir todo al staff autenticado para empezar)
CREATE POLICY "Acceso total a autenticados" ON "Profiles" FOR ALL USING (auth.role() = 'authenticated');
CREATE POLICY "Acceso total a autenticados" ON "Products" FOR ALL USING (auth.role() = 'authenticated');
CREATE POLICY "Acceso total a autenticados" ON "Customers" FOR ALL USING (auth.role() = 'authenticated');
CREATE POLICY "Acceso total a autenticados" ON "Orders" FOR ALL USING (auth.role() = 'authenticated');


VARIABLES DE ENTRONO PARA ACCESO A SUPABASE:

VITE_SUPABASE_URL=
VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY=